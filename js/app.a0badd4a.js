(function(t){function e(e){for(var a,r,c=e[0],d=e[1],o=e[2],u=0,p=[];u<c.length;u++)r=c[u],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&p.push(s[r][0]),s[r]=0;for(a in d)Object.prototype.hasOwnProperty.call(d,a)&&(t[a]=d[a]);l&&l(e);while(p.length)p.shift()();return i.push.apply(i,o||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],a=!0,c=1;c<n.length;c++){var d=n[c];0!==s[d]&&(a=!1)}a&&(i.splice(e--,1),t=r(r.s=n[0]))}return t}var a={},s={app:0},i=[];function r(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=a,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(n,a,function(e){return t[e]}.bind(null,a));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/sync.payments/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],d=c.push.bind(c);c.push=e,c=c.slice();for(var o=0;o<c.length;o++)e(c[o]);var l=d;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"034f":function(t,e,n){"use strict";var a=n("64a9"),s=n.n(a);s.a},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var a=n("2b0e"),s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("Main")],1)},i=[],r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"add-payment",on:{"&transitionend":function(e){return t.onElResize(e)}}},[n("p",[t._v("Демо для сделки стоимостью 30 000 руб. Данные сохраняются локально.")]),n("p",[n("span",{directives:[{name:"show",rawName:"v-show",value:t.connected,expression:"connected"}],staticClass:"pseudo",on:{click:function(e){return t.setConnected(!1)}}},[t._v("Имитировать отключение сервера данных (с откатом изменений)")])]),t.connected?t._e():n("div",{staticClass:"connection-problem"},[t._m(0)]),t.showPayments?n("div",{staticClass:"payments__holder"},t._l(t.payments,(function(e){return n("Payment",{directives:[{name:"show",rawName:"v-show",value:t.connected,expression:"connected"}],key:e.id,attrs:{payment:e,deal:t.deal}})})),1):t._e(),t.isWriteable&&0===t.getUnpaid&&0===t.getSum?n("div",{staticClass:"add-payment__actions"},[t._v("\n\t\tДобавление оплат доступно при сумме сделки больше нуля\n\t")]):t._e(),t.isWriteable?n("div",{directives:[{name:"show",rawName:"v-show",value:t.getUnpaid>0,expression:"getUnpaid > 0"}],staticClass:"add-payment__actions"},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.active,expression:"active"}],staticClass:"add-payment__form"},[n("form",{attrs:{method:"post"},on:{submit:function(e){return e.preventDefault(),t.submit(e)}}},[n("div",{staticClass:"form-group"},[n("label",{attrs:{for:"addType"}},[t._v("Способ оплаты")]),n("select",{directives:[{name:"model",rawName:"v-model",value:t.type,expression:"type"}],staticClass:"form-control",attrs:{name:"type",id:"addType",disabled:t.isPending},on:{change:function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.type=e.target.multiple?n:n[0]}}},[n("option",{attrs:{value:"sberbank"}},[t._v("\n\t\t\t\t\t\t\tОплата через Сбербанк.Эквайринг\n\t\t\t\t\t\t")]),n("option",{attrs:{value:"cashless"}},[t._v("\n\t\t\t\t\t\t\tБезналичная оплата от юридического лица\n\t\t\t\t\t\t")]),n("option",{attrs:{value:"cash"}},[t._v("\n\t\t\t\t\t\t\tОплата наличными\n\t\t\t\t\t\t")]),n("option",{attrs:{value:"acquiring"}},[t._v("\n\t\t\t\t\t\t\tОплата картой через терминал\n\t\t\t\t\t\t")])])]),n("div",{staticClass:"form-group"},[n("label",{attrs:{for:"addSum"}},[t._v("Сумма к оплате (осталось оплатить по сделке\n\t\t\t\t\t\t"),n("span",{staticClass:"setlink",on:{click:function(e){return t.setSum(t.getUnpaid)}}},[t._v(t._s(t.getUnpaid))]),t._v("\n\t\t\t\t\t\tруб.)")]),n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.$v.sum.$model,expression:"$v.sum.$model",modifiers:{number:!0}}],staticClass:"form-control form-control_small",class:{"is-invalid":t.$v.sum.$error},attrs:{type:"number",name:"sum",id:"addSum",disabled:t.isPending},domProps:{value:t.$v.sum.$model},on:{input:function(e){e.target.composing||t.$set(t.$v.sum,"$model",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),t._v("\n\t\t\t\t\tруб.\n\t\t\t\t")]),t.$v.sum.between?t._e():n("div",{staticClass:"form-group"},[n("div",{staticClass:"ui-alert ui-alert-danger"},[t._v("\n\t\t\t\t\t\tОплата не должна быть больше оставшейся суммы к оплате -\n\t\t\t\t\t\t"+t._s(t.getUnpaid)+" руб.\n\t\t\t\t\t")])]),"sberbank"===t.type?n("div",{staticClass:"form-group form-check"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.sendpayment,expression:"sendpayment"}],staticClass:"form-check-input",attrs:{name:"sendpayment",type:"checkbox",value:"Y",id:"sendpayment"},domProps:{checked:Array.isArray(t.sendpayment)?t._i(t.sendpayment,"Y")>-1:t.sendpayment},on:{change:function(e){var n=t.sendpayment,a=e.target,s=!!a.checked;if(Array.isArray(n)){var i="Y",r=t._i(n,i);a.checked?r<0&&(t.sendpayment=n.concat([i])):r>-1&&(t.sendpayment=n.slice(0,r).concat(n.slice(r+1)))}else t.sendpayment=s}}}),n("label",{staticClass:"form-check-label",attrs:{for:"sendpayment"}},[t._v("\n\t\t\t\t\t\tОтправить клиенту ссылку на оплату\n\t\t\t\t\t")])]):t._e(),"cash"===t.type||"cashless"===t.type||"acquiring"===t.type?n("div",{staticClass:"form-group form-check"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.paid,expression:"paid"}],staticClass:"form-check-input",attrs:{name:"paid",type:"checkbox",value:"Y",id:"paid"},domProps:{checked:Array.isArray(t.paid)?t._i(t.paid,"Y")>-1:t.paid},on:{change:function(e){var n=t.paid,a=e.target,s=!!a.checked;if(Array.isArray(n)){var i="Y",r=t._i(n,i);a.checked?r<0&&(t.paid=n.concat([i])):r>-1&&(t.paid=n.slice(0,r).concat(n.slice(r+1)))}else t.paid=s}}}),n("label",{staticClass:"form-check-label",attrs:{for:"paid"}},[t._v("\n\t\t\t\t\t\tОплачено\n\t\t\t\t\t")])]):t._e(),t.errors.length?n("div",{staticClass:"form-group payment__errors"},t._l(t.errors,(function(e,a){return n("div",{key:a,staticClass:"ui-alert ui-alert-danger"},[t._v("\n\t\t\t\t\t\t"+t._s(e)+"\n\t\t\t\t\t")])})),0):t._e(),n("button",{staticClass:"ui-btn ui-btn-primary",class:{"ui-btn-clock":t.isPending},attrs:{type:"submit"}},[t._v("\n\t\t\t\t\tОтправить")]),n("span",{staticClass:"ui-btn ui-btn-link",on:{click:function(e){return t.changeActive(!1)}}},[t._v("Отменить")])])]),t.active?t._e():n("span",{directives:[{name:"show",rawName:"v-show",value:t.connected,expression:"connected"}],staticClass:"ui-btn ui-btn-default",on:{click:function(e){return t.changeActive(!0)}}},[t._v("Добавить оплату")])]):t._e()])},c=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"info-widget"},[n("span",{staticClass:"info-widget__image"}),n("span",{staticClass:"info-widget__text"},[n("span",{staticClass:"info-widget__title"},[t._v("Ошибка соединения с сайтом")]),n("span",{staticClass:"info-widget__description"},[t._v("Подключаемся...")])])])}],d=(n("8e6e"),n("ac6a"),n("456d"),n("bd86")),o=n("1dce"),l=n.n(o),u=n("2f62"),p=n("b5ae"),m=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"payment"},[n("div",{staticClass:"payment__head",attrs:{"data-payment":t.payment.id}},[n("div",{staticClass:"payment__title"},[t._v("\n\t\t\t"+t._s(t.isSberbank?"Оплата через":"")+" "+t._s(t.payment.name)+"\n\t\t\t"),n("span",{directives:[{name:"show",rawName:"v-show",value:"ready"===t.editstate&&t.isEditable,expression:"editstate === 'ready' && isEditable"}],staticClass:"payment__edit",on:{click:function(e){t.editstate="editing"}}},[n("svg",{attrs:{width:"11",height:"11",xmlns:"http://www.w3.org/2000/svg"}},[n("g",{attrs:{id:"svg_1","fill-rule":"evenodd",fill:"none"}},[n("path",{attrs:{id:"svg_3",d:"m8.562784,0.499l1.92862,1.92862l-6.91754,6.91616l-1.92862,-1.92862l6.91754,-6.91616zm-8.05455,9.72344c-0.01934,0.07322 0.00139,0.15059 0.05388,0.20447c0.05388,0.05388 0.13125,0.0746 0.20447,0.05388l2.28644,-0.61617l-1.92862,-1.92862l-0.61617,2.28644z","fill-rule":"nonzero",fill:"#525C69"}}),n("path",{attrs:{id:"svg_5",d:"m22.88307,166.34617l-1.10511,-1.10512c-0.16073,-0.16069 -0.35171,-0.24105 -0.57278,-0.24105c-0.22078,0 -0.41191,0.08036 -0.57249,0.24105l-6.49955,6.49951l-2.64181,-2.64199c-0.16076,-0.16079 -0.35167,-0.24105 -0.5726,-0.24105c-0.22096,0 -0.4118,0.08026 -0.57259,0.24105l-1.10498,1.10498c-0.16073,0.16072 -0.24116,0.35164 -0.24116,0.5727c0,0.22096 0.08043,0.4118 0.24116,0.5726l4.31953,4.31953c0.16076,0.16083 0.35167,0.24105 0.5726,0.24105c0.22092,0 0.4118,-0.08018 0.57259,-0.24105l8.17709,-8.17705c0.16062,-0.16069 0.24116,-0.35164 0.24116,-0.5726c0,-0.22096 -0.08033,-0.41187 -0.24106,-0.57256z","fill-rule":"nonzero",fill:"#FFFFFF"}})])])])]),n("div",{staticClass:"payment__actions"})]),n("transition",{attrs:{name:"fade",mode:"out-in"},on:{"after-leave":t.onElResize}},["delete"===t.editstate&&t.isEditable?n("div",{key:"paydelete",staticClass:"payment__form"},[n("div",{staticClass:"form-group"},[t._v("\n\t\t\t\tОплата удаляется безвозвратно. Вы подтверждаете удаление данной\n\t\t\t\tоплаты?\n\t\t\t")]),n("button",{staticClass:"ui-btn ui-btn-danger-light",class:{"ui-btn-clock":t.isPending},on:{click:t.deletepayment}},[t._v("\n\t\t\t\tПодтвердить")]),n("span",{staticClass:"ui-btn ui-btn-link",on:{click:function(e){t.editstate="ready"}}},[t._v("Отменить")])]):"ready"!==t.editstate&&t.isEditable?n("div",{key:"payedit",staticClass:"payment__form"},[n("div",{staticClass:"form-group"},[n("label",{attrs:{for:"paymentSum"+t.payment.id}},[t._v("Сумма к оплате (не более\n\t\t\t\t\t"),n("span",{staticClass:"setlink",on:{click:function(e){return t.setMax(t.maxPayment)}}},[t._v(t._s(t.maxPayment))]),t._v("\n\t\t\t\t\tруб.)")]),n("input",{directives:[{name:"model",rawName:"v-model.number",value:t.$v.editsum.$model,expression:"$v.editsum.$model",modifiers:{number:!0}}],staticClass:"form-control form-control_small",class:{"is-invalid":t.$v.editsum.$error},attrs:{type:"number",name:"editsum",id:"paymentSum"+t.payment.id,disabled:t.isPending},domProps:{value:t.$v.editsum.$model},on:{input:function(e){e.target.composing||t.$set(t.$v.editsum,"$model",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}}),t._v("\n\t\t\t\tруб.\n\t\t\t")]),"cash"===t.payment.type||"cashless"===t.payment.type||"acquiring"===t.payment.type?n("div",{staticClass:"form-group form-check"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.editpaid,expression:"editpaid"}],staticClass:"form-check-input",attrs:{name:"paid",type:"checkbox",id:"paid"+t.payment.id},domProps:{checked:Array.isArray(t.editpaid)?t._i(t.editpaid,null)>-1:t.editpaid},on:{change:function(e){var n=t.editpaid,a=e.target,s=!!a.checked;if(Array.isArray(n)){var i=null,r=t._i(n,i);a.checked?r<0&&(t.editpaid=n.concat([i])):r>-1&&(t.editpaid=n.slice(0,r).concat(n.slice(r+1)))}else t.editpaid=s}}}),n("label",{staticClass:"form-check-label",attrs:{for:"paid"+t.payment.id}},[t._v("\n\t\t\t\t\tОплачено\n\t\t\t\t")])]):t._e(),n("button",{staticClass:"ui-btn ui-btn-primary",class:{"ui-btn-clock":t.isPending},attrs:{type:"submit"},on:{click:t.editpayment}},[t._v("\n\t\t\t\tСохранить")]),n("span",{staticClass:"ui-btn ui-btn-light-border",on:{click:function(e){t.editstate="delete"}}},[t._v("Удалить оплату")]),n("span",{staticClass:"ui-btn ui-btn-link",on:{click:function(e){t.editstate="ready"}}},[t._v("Отменить")])]):n("div",{key:"paytext"},[n("div",{staticClass:"payment__details"},[n("div",{staticClass:"payment__sum"},[t._v(t._s(t.payment.sum)+" руб.")]),n("div",{staticClass:"payment__status"},[t.payment.paid?t._e():n("span",{staticClass:"label label_error"},[t._v("Не оплачено")]),t.payment.paid?n("span",{staticClass:"label label_success"},[t._v("Оплачено")]):t._e()])]),t.isSberbank?n("div",{staticClass:"payment__additional"},[t.payment.paid?n("div",[t._v("Оплачено "+t._s(t.payment.paiddate))]):t._e(),t.payment.paid?t._e():n("div",{staticClass:"payment__additional-item",class:{important:!t.payment.sended}},[t._v("\n\t\t\t\t\t"+t._s(t.payment.sended?"Ссылка на оплату отправлена "+t.payment.sended:"Ссылка на оплату не отправлена")+"\n\t\t\t\t")]),t.hasChecks?n("div",{staticClass:"payment__additional-item"},[t.payment.check.length?t._l(t.payment.check,(function(e,a){return n("div",{key:a,staticClass:"payment__additional-item"},[e.link?n("a",{staticClass:"link",attrs:{href:e.link,target:"_blank"}},[t._v("Чек №"+t._s(e.id))]):t._e(),e.link?t._e():n("span",{staticClass:"sending"},[n("i",[t._v("Чек печатается")])])])})):t._e()],2):t._e(),t.payment.paid?t._e():n("div",{staticClass:"payment__additional-item"},[n("transition",{attrs:{name:"fade",mode:"out-in"}},["confirm"===t.state?n("span",{key:"confirm",staticClass:"confirm"},[n("i",[t._v("Вы уверены?")]),n("span",{staticClass:"pseudo",on:{click:function(e){return t.sendlink(!0)}}},[t._v("Да")]),n("span",{staticClass:"pseudo",on:{click:function(e){return t.sendlink(!1)}}},[t._v("Нет")])]):"sending"===t.state?n("span",{key:"sending",staticClass:"sending"},[n("i",[t._v("Отправка")])]):n("span",{key:"ready",staticClass:"pseudo",on:{click:function(e){return t.sendlink(!0)}}},[t._v(t._s(t.payment.sended?"Отправить еще раз":"Отправить"))])])],1)]):t._e(),t.isSberbank?t._e():n("div",{staticClass:"payment__additional"},[t.isCashless?n("div",{staticClass:"payment__additional-item"},[t._v('\n\t\t\t\t\tПодробнее см. на вкладке "Счета"\n\t\t\t\t')]):t._e(),t.isCash||t.isAcquiring?n("div",{staticClass:"payment__additional-item"},[t._v('\n\t\t\t\t\tПодробнее см. на вкладке "Заказ на сайте"\n\t\t\t\t')]):t._e(),t.hasChecks?t._l(t.payment.check,(function(e,a){return n("div",{key:a,staticClass:"payment__additional-item"},[e.link?n("a",{staticClass:"link",attrs:{href:e.link,target:"_blank"}},[t._v("Чек №"+t._s(e.id))]):t._e(),e.link?t._e():n("span",{staticClass:"sending"},[n("i",[t._v("Чек печатается")])])])})):t._e()],2)])]),t.errors.length?n("div",{staticClass:"payment__errors"},t._l(t.errors,(function(e,a){return n("div",{key:a,staticClass:"ui-alert ui-alert-danger"},[t._v("\n\t\t\t"+t._s(e)+"\n\t\t")])})),0):t._e()],1)},y=[];function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function v(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(n,!0).forEach((function(e){Object(d["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var h={data:function(){return{state:"ready",editstate:"ready",editsum:0,editpaid:!1,formstate:"ready",errors:[],currentHeight:0}},name:"Payment",props:["payment","deal"],computed:v({},Object(u["c"])(["getUnpaid"]),{isCashless:function(){return"cashless"===this.payment.type},isCash:function(){return"cash"===this.payment.type},isSberbank:function(){return"sberbank"===this.payment.type},isAcquiring:function(){return"acquiring"===this.payment.type},isEditable:function(){if(this.isSberbank){if(!this.payment.paid)return!0}else if(!this.payment.check)return!0;return!1},isPending:function(){return"pending"===this.formstate},maxPayment:function(){return this.getUnpaid+this.payment.sum},hasChecks:function(){return"undefined"!==typeof this.payment.check&&this.payment.check.length>0}}),methods:v({},Object(u["b"])(["setPaid","setConnected"]),{onElResize:function(){this.$emit("onElResize")},setMax:function(t){this.editsum=t,this.$v.editsum.$touch()},sendlink:function(t){var e=this;this.errors=[],t?(this.payment.sended&&"confirm"===this.state?this.state="sending":this.payment.sended?this.state="confirm":this.state="sending","sending"===this.state&&setTimeout((function(){e.setPaid({payment:e.payment.id,sended:"(дата отправки с сервера)"}),e.state="ready"}),3e3)):this.state="ready"},deletepayment:function(){var t=this;this.formstate="pending",this.errors=[],setTimeout((function(){a["a"].delete(t.$store.state.payments,t.payment.id),t.formstate="ready"}),3e3)},editpayment:function(){var t=this;this.formstate="pending",this.errors=[],setTimeout((function(){if(a["a"].set(t.$store.state.payments[t.payment.id],"sum",t.editsum),!t.isSberbank&&(a["a"].set(t.$store.state.payments[t.payment.id],"paid",t.editpaid),"cash"===t.payment.type||"acquiring"===t.payment.type)){var e=[];e.push({id:"100"}),a["a"].set(t.$store.state.payments[t.payment.id],"check",e),setTimeout((function(){a["a"].set(t.$store.state.payments[t.payment.id].check[0],"link","https://ya.ru")}),5e3)}t.formstate=t.editstate="ready"}),3e3)}}),validations:function(){return{editsum:{required:p["required"],between:Object(p["between"])(1,this.maxPayment)}}},mounted:function(){"undefined"!==typeof this.payment.sum&&(this.editsum=this.payment.sum),"undefined"!==typeof this.payment.paid&&(this.editpaid=this.payment.paid)}},_=h,b=n("2877"),g=Object(b["a"])(_,m,y,!1,null,null,null),k=g.exports;function C(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,a)}return n}function w(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?C(n,!0).forEach((function(e){Object(d["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):C(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}a["a"].use(l.a);var O={data:function(){return{deal:100,active:!1,type:"sberbank",sum:"",status:"OK",timer:!1,updateIntervalDefault:6e3,updateIntervalEmergency:10,sendpayment:!0,paid:!1,errors:[],currentHeight:0}},name:"Main",components:{Payment:k},computed:w({},Object(u["d"])(["payments","loaded","connected"]),{},Object(u["c"])(["getUnpaid","isReadable","isWriteable","getSum","getNewId"]),{isPending:function(){return"PENDING"===this.status},showPayments:function(){return Object.keys(this.payments).length>0&&this.isReadable}}),mounted:function(){var t=this;"undefined"!==typeof this.deal&&""!==this.deal&&(this.$store.dispatch("load",{deal:this.deal}),this.timer=setInterval((function(){t.$store.dispatch("load")}),1e3*parseInt(this.updateIntervalDefault))),this.onElResize()},methods:w({},Object(u["b"])(["setPaid","setConnected","addPayment"]),{onElResize:function(){window.updateParent&&"function"===typeof window.updateParent&&window.updateParent()},setSum:function(t){this.sum=t,this.$v.sum.$touch()},changeActive:function(t){this.active=t,this.onElResize()},submit:function(){var t=this;this.errors=[],this.$v.$touch(),this.$v.$invalid?this.status="ERROR":(this.status="PENDING",setTimeout((function(){var e=t.getNewId,n={sberbank:"Сбербанк.Эквайринг",cashless:"Безналичная оплата от юридического лица",cash:"Оплата наличными",acquiring:"Оплата картой через терминал"},s={id:e,name:n[t.type],type:t.type,paid:t.paid,sum:t.sum,paiddate:!1,sended:!1};t.sendpayment&&"sberbank"===t.type&&(s["sended"]="(дата отправки с сервера)",s["paid"]=!1),t.paid&&(s["paiddate"]="(дата с сервера)","cash"!==t.type&&"acquiring"!==t.type||(s["check"]=[],s["check"].push({id:"100"}))),a["a"].set(t.$store.state.payments,e,s),t.paid&&("cash"!==t.type&&"acquiring"!==t.type||setTimeout((function(){a["a"].set(t.$store.state.payments[e].check[0],"link","https://ya.ru")}),5e3)),t.status="OK",t.active=!1}),3e3))}}),validations:function(){return{sum:{required:p["required"],between:Object(p["between"])(1,this.getUnpaid)}}},watch:{connected:function(t){var e=this;this.timer&&window.clearInterval(this.timer),this.timer=setInterval((function(){e.$store.dispatch("load")}),!1===t?1e3*parseInt(this.updateIntervalEmergency):1e3*parseInt(this.updateIntervalDefault))}}},P=O,$=Object(b["a"])(P,r,c,!1,null,null,null),j=$.exports,x={components:{Main:j}},S=x,E=(n("034f"),Object(b["a"])(S,s,i,!1,null,null,null)),N=E.exports,A=n("bc3a"),D=n.n(A);a["a"].use(u["a"]);var I=new u["a"].Store({state:{payments:{},deal:[],loaded:!1,connected:!0,access:"N"},getters:{getSum:function(t){return"undefined"!==typeof t.deal.OPPORTUNITY?parseFloat(t.deal.OPPORTUNITY):0},getUnpaid:function(t,e){var n=e.getSum;for(var a in t.payments)t.payments.hasOwnProperty(a)&&(n-=t.payments[a].sum);return n>0?n:0},isReadable:function(t){return"W"===t.access||"R"===t.access},isWriteable:function(t){return"W"===t.access},getNewId:function(t){return Math.round(Object.keys(t.payments)[Object.keys(t.payments).length-1])+1}},mutations:{setPayments:function(t,e){t.payments=e},setConnected:function(t,e){t.connected=e},setLoaded:function(t,e){t.loaded=e},setAccess:function(t,e){t.access=e},setDeal:function(t,e){t.deal=e},setSended:function(t,e){t.payments[e.payment].sended=e.sended}},actions:{load:function(t,e){var n=t.commit,a=t.state,s={JSON:"Y"};return"undefined"!==typeof e?"undefined"!==typeof e.deal&&parseInt(e.deal)>0&&(s["DEAL"]=e.deal):"undefined"!==typeof a.deal.ID&&""!==a.deal.ID&&(s["DEAL"]=a.deal.ID),D.a.get("https://h4mpy-395f0.firebaseio.com/sync-payment.json",{params:s}).then((function(t){200===t.status?(n("setConnected",!0),"undefined"!==typeof t.data.payments?n("setPayments",t.data.payments):n("setPayments",{}),"undefined"!==typeof t.data.access?n("setAccess",t.data.access):n("setAccess","N"),"undefined"!==typeof t.data.deal?n("setDeal",t.data.deal):n("setDeal",[])):n("setConnected",!1)})).catch((function(){n("setConnected",!1)})).finally((function(){n("setLoaded",!0)}))},setPaid:function(t,e){var n=t.commit;"undefined"!==typeof e&&"undefined"!==typeof e.payment&&"undefined"!==typeof e.sended&&n("setSended",e)},setConnected:function(t,e){var n=t.commit;n("setConnected",e)}}});a["a"].config.productionTip=!1,new a["a"]({store:I,render:function(t){return t(N)}}).$mount("#app")},"64a9":function(t,e,n){}});
//# sourceMappingURL=app.a0badd4a.js.map